/* Dark Mode Theme for Labitory
 * This file is part of the Labitory.
 * Copyright (C) 2025 Labitory Contributors
 *
 * This software is dual-licensed:
 * 1. GNU General Public License v3.0 (GPL-3.0) - for open source use
 * 2. Commercial License - for proprietary and commercial use
 */

/* Enhanced Focus and Accessibility CSS Variables */
:root {
    --focus-color: #0d6efd;
    --focus-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
    --focus-shadow-dark: 0 0 0 0.25rem rgba(66, 153, 225, 0.4);
    --high-contrast-text: #000000;
    --high-contrast-bg: #ffffff;
    
    /* === DESIGN TOKEN SYSTEM - LIGHT THEME === */
    
    /* Primary Colors */
    --color-primary: #0d6efd;
    --color-primary-hover: #0b5ed7;
    --color-primary-active: #0a58ca;
    --color-primary-light: #cfe2ff;
    --color-primary-lighter: #e7f1ff;
    
    /* Success Colors */
    --color-success: #1e7e34;
    --color-success-hover: #218838;
    --color-success-active: #155724;
    --color-success-light: #d4edda;
    --color-success-lighter: #f8fff9;
    --color-success-text: #155724;
    
    /* Danger Colors */
    --color-danger: #dc3545;
    --color-danger-hover: #c82333;
    --color-danger-active: #bd2130;
    --color-danger-light: #f8d7da;
    --color-danger-lighter: #fff8f8;
    --color-danger-text: #721c24;
    
    /* Warning Colors */
    --color-warning: #ffc107;
    --color-warning-hover: #e0a800;
    --color-warning-active: #d39e00;
    --color-warning-light: #fff3cd;
    --color-warning-lighter: #fffbf0;
    --color-warning-text: #856404;
    
    /* Info Colors */
    --color-info: #17a2b8;
    --color-info-hover: #138496;
    --color-info-active: #117a8b;
    --color-info-light: #d1ecf1;
    --color-info-lighter: #f0faff;
    --color-info-text: #0c5460;
    
    /* Gray Scale */
    --color-gray-100: #f8f9fa;
    --color-gray-200: #e9ecef;
    --color-gray-300: #dee2e6;
    --color-gray-400: #ced4da;
    --color-gray-500: #adb5bd;
    --color-gray-600: #6c757d;
    --color-gray-700: #495057;
    --color-gray-800: #343a40;
    --color-gray-900: #212529;
    
    /* Text Colors */
    --color-text-primary: #212529;
    --color-text-secondary: #495057;
    --color-text-muted: #495057;
    --color-text-light: #ffffff;
    
    /* Background Colors */
    --color-bg-primary: #ffffff;
    --color-bg-secondary: #f8f9fa;
    --color-bg-tertiary: #e9ecef;
    
    /* Border Colors */
    --color-border-light: #dee2e6;
    --color-border-medium: #ced4da;
    --color-border-dark: #adb5bd;
}

/* Dark Mode CSS Variables */
[data-theme="dark"] {
    --bs-body-bg: #1a1a1a;
    --bs-body-color: #e9ecef;
    --bs-primary: #4299e1; /* Higher contrast blue for dark mode */
    --bs-secondary: #a0aec0; /* Higher contrast gray */
    --bs-success: #38a169; /* Higher contrast green */
    --bs-danger: #e53e3e; /* Higher contrast red */
    --bs-warning: #d69e2e; /* Higher contrast yellow */
    --bs-info: #3182ce; /* Higher contrast info blue */
    --bs-light: #2d3748;
    --bs-dark: #f7fafc;
    --bs-border-color: #4a5568;
    --focus-color: #4299e1;
    
    /* === DESIGN TOKEN SYSTEM - DARK THEME === */
    
    /* Primary Colors */
    --color-primary: #5bb3f0;
    --color-primary-hover: #4299e1;
    --color-primary-active: #3182ce;
    --color-primary-light: #2d3748;
    --color-primary-lighter: #1a202c;
    
    /* Success Colors */
    --color-success: #4ade80;
    --color-success-hover: #38a169;
    --color-success-active: #2f855a;
    --color-success-light: #22543d;
    --color-success-lighter: #1a202c;
    --color-success-text: #9ae6b4;
    
    /* Danger Colors */
    --color-danger: #e53e3e;
    --color-danger-hover: #c53030;
    --color-danger-active: #9b2c2c;
    --color-danger-light: #742a2a;
    --color-danger-lighter: #1a202c;
    --color-danger-text: #feb2b2;
    
    /* Warning Colors */
    --color-warning: #d69e2e;
    --color-warning-hover: #b7791f;
    --color-warning-active: #975a16;
    --color-warning-light: #744210;
    --color-warning-lighter: #1a202c;
    --color-warning-text: #f6e05e;
    
    /* Info Colors */
    --color-info: #3182ce;
    --color-info-hover: #2b77cb;
    --color-info-active: #2c5282;
    --color-info-light: #2a4365;
    --color-info-lighter: #1a202c;
    --color-info-text: #90cdf4;
    
    /* Gray Scale - Fixed dark theme mapping */
    --color-gray-100: #f9fafb;  /* Lightest for dark theme text */
    --color-gray-200: #e5e7eb;
    --color-gray-300: #d1d5db;
    --color-gray-400: #9ca3af;
    --color-gray-500: #6b7280;
    --color-gray-600: #4a5568;
    --color-gray-700: #374151;
    --color-gray-800: #2d3748;
    --color-gray-900: #1a202c;  /* Darkest for dark theme backgrounds */
    
    /* Text Colors */
    --color-text-primary: #e9ecef;
    --color-text-secondary: #a0aec0;
    --color-text-muted: #9ca3af;
    --color-text-light: #ffffff;
    
    /* Background Colors */
    --color-bg-primary: #1a1a1a;
    --color-bg-secondary: #2d3748;
    --color-bg-tertiary: #374151;
    
    /* Border Colors */
    --color-border-light: #374151;
    --color-border-medium: #4a5568;
    --color-border-dark: #6b7280;
}

/* Global Dark Mode Styles */
[data-theme="dark"] body {
    background-color: #1a1a1a !important;
    color: #e9ecef !important;
}

/* Navigation - Enhanced specificity for dark mode */
[data-theme="dark"] .navbar.navbar-dark.bg-dark,
[data-theme="dark"] .navbar-dark.bg-dark,
[data-theme="dark"] .navbar.bg-dark,
[data-theme="dark"] nav.navbar.bg-dark,
[data-theme="dark"] nav.navbar-dark {
    background-color: var(--color-gray-900) !important;
    border-bottom: 1px solid var(--color-border-medium);
}

[data-theme="dark"] .bg-dark,
[data-theme="dark"] nav.bg-dark {
    background-color: var(--color-gray-900) !important;
}

/* Extra specificity for Bootstrap navbar classes */
[data-theme="dark"] nav.navbar.navbar-dark.bg-dark.fixed-top {
    background-color: var(--color-gray-900) !important;
}

/* Navbar text and links - Enhanced specificity */
[data-theme="dark"] .navbar-dark .navbar-brand,
[data-theme="dark"] .navbar-dark .nav-link,
[data-theme="dark"] .navbar .navbar-brand,
[data-theme="dark"] .navbar .nav-link,
[data-theme="dark"] .navbar .navbar-nav .nav-link {
    color: var(--color-text-light) !important;
}

[data-theme="dark"] .navbar-dark .navbar-brand:hover,
[data-theme="dark"] .navbar-dark .nav-link:hover,
[data-theme="dark"] .navbar .navbar-brand:hover,
[data-theme="dark"] .navbar .nav-link:hover,
[data-theme="dark"] .navbar .navbar-nav .nav-link:hover {
    color: var(--color-primary) !important;
}

/* Navbar brand text specifically */
[data-theme="dark"] .navbar-brand span,
[data-theme="dark"] .navbar-brand small {
    color: var(--color-text-light) !important;
}

[data-theme="dark"] .navbar-brand small.text-muted {
    color: var(--color-text-secondary) !important;
}

/* Dropdown menus in navbar */
[data-theme="dark"] .navbar .dropdown-menu {
    background-color: var(--color-bg-secondary) !important;
    border-color: var(--color-border-medium) !important;
}

/* Sidebar */
[data-theme="dark"] .sidebar {
    background-color: #2d3748 !important;
    border-right: 1px solid #495057 !important;
}

[data-theme="dark"] .sidebar.bg-light {
    background-color: #2d3748 !important;
}

[data-theme="dark"] .nav-link {
    color: #cbd5e0 !important;
}

[data-theme="dark"] .nav-link:hover,
[data-theme="dark"] .nav-link.active {
    background-color: #4a5568 !important;
    color: #fff !important;
}

[data-theme="dark"] .sidebar-heading {
    color: #a0aec0 !important;
}

/* Cards */
[data-theme="dark"] .card {
    background-color: #2d3748 !important;
    border-color: #495057 !important;
    color: #e9ecef !important;
}

[data-theme="dark"] .card-header {
    background-color: #374151 !important;
    border-color: #495057 !important;
}

/* Card titles inherit card text color in dark mode */
[data-theme="dark"] .card .card-title {
    color: inherit !important;
}

/* Tables */
[data-theme="dark"] .table {
    color: #e9ecef !important;
    background-color: #2d3748 !important;
}

[data-theme="dark"] .table-hover tbody tr:hover {
    background-color: #374151 !important;
}

[data-theme="dark"] .table-light {
    background-color: #374151 !important;
    color: #e9ecef !important;
}

/* Forms */
[data-theme="dark"] .form-control,
[data-theme="dark"] .form-select {
    background-color: #374151 !important;
    border-color: #6b7280 !important;
    color: #e9ecef !important;
}

[data-theme="dark"] .form-control:focus,
[data-theme="dark"] .form-select:focus {
    background-color: #374151 !important;
    border-color: #60a5fa !important;
    box-shadow: 0 0 0 0.2rem rgba(96, 165, 250, 0.25) !important;
    color: #e9ecef !important;
}

[data-theme="dark"] .form-control::placeholder {
    color: #9ca3af !important;
}

/* Modals */
[data-theme="dark"] .modal-content {
    background-color: #2d3748 !important;
    border-color: #495057 !important;
}

[data-theme="dark"] .modal-header {
    border-color: #495057 !important;
}

[data-theme="dark"] .modal-footer {
    border-color: #495057 !important;
}

/* Buttons */
[data-theme="dark"] .btn-outline-secondary {
    color: #e9ecef !important;
    border-color: #6c757d !important;
}

[data-theme="dark"] .btn-outline-secondary:hover {
    background-color: #6c757d !important;
    border-color: #6c757d !important;
    color: #fff !important;
}

/* Alerts */
[data-theme="dark"] .alert-success {
    background-color: #064e3b !important;
    border-color: #059669 !important;
    color: #a7f3d0 !important;
}

[data-theme="dark"] .alert-danger {
    background-color: #7f1d1d !important;
    border-color: #dc2626 !important;
    color: #fecaca !important;
}

[data-theme="dark"] .alert-warning {
    background-color: #451a03 !important;
    border-color: #d97706 !important;
    color: #fed7aa !important;
}

[data-theme="dark"] .alert-info {
    background-color: #0c4a6e !important;
    border-color: #0891b2 !important;
    color: #bae6fd !important;
}

/* Badges */
[data-theme="dark"] .badge.bg-light {
    background-color: #4b5563 !important;
    color: #e5e7eb !important;
}

[data-theme="dark"] .badge.bg-secondary {
    background-color: #6b7280 !important;
}

/* Background Utilities */
[data-theme="dark"] .bg-light {
    background-color: #2d3748 !important;
    color: #e9ecef !important;
}

[data-theme="dark"] footer.bg-light {
    background-color: #1f2937 !important;
    border-color: #374151 !important;
}

/* Text Utilities */
[data-theme="dark"] .text-muted {
    color: #9ca3af !important;
}

[data-theme="dark"] .text-dark {
    color: #e5e7eb !important;
}

/* Borders */
[data-theme="dark"] .border-top {
    border-color: #374151 !important;
}

/* Breadcrumbs */
[data-theme="dark"] .breadcrumb {
    background-color: transparent !important;
}

[data-theme="dark"] .breadcrumb-item a {
    color: #60a5fa !important;
}

[data-theme="dark"] .breadcrumb-item.active {
    color: #9ca3af !important;
}

/* Dropdowns */
[data-theme="dark"] .dropdown-menu {
    background-color: #374151 !important;
    border-color: #6b7280 !important;
}

[data-theme="dark"] .dropdown-item {
    color: #e5e7eb !important;
}

[data-theme="dark"] .dropdown-item:hover,
[data-theme="dark"] .dropdown-item:focus {
    background-color: #4b5563 !important;
    color: #fff !important;
}

[data-theme="dark"] .dropdown-header {
    color: #9ca3af !important;
}

[data-theme="dark"] .dropdown-divider {
    border-color: #6b7280 !important;
}

/* Notification Dropdown */
[data-theme="dark"] .notification-dropdown .dropdown-header {
    background-color: #374151 !important;
    color: #e5e7eb !important;
}

[data-theme="dark"] .notification-preview {
    background-color: #374151 !important;
    color: #e5e7eb !important;
}

/* Pagination */
[data-theme="dark"] .page-link {
    background-color: #374151 !important;
    border-color: #6b7280 !important;
    color: #e5e7eb !important;
}

[data-theme="dark"] .page-link:hover {
    background-color: #4b5563 !important;
    border-color: #6b7280 !important;
    color: #fff !important;
}

[data-theme="dark"] .page-item.active .page-link {
    background-color: #3b82f6 !important;
    border-color: #3b82f6 !important;
}

/* Calendar */
[data-theme="dark"] .calendar-wrapper {
    background-color: #2d3748 !important;
    border-color: #495057 !important;
}

[data-theme="dark"] .fc {
    color: #e9ecef !important;
}

[data-theme="dark"] .fc-theme-standard td,
[data-theme="dark"] .fc-theme-standard th {
    border-color: #495057 !important;
}

[data-theme="dark"] .fc-theme-standard .fc-scrollgrid {
    border-color: #495057 !important;
}

[data-theme="dark"] .fc-button {
    background-color: #374151 !important;
    border-color: #6b7280 !important;
    color: #e5e7eb !important;
}

[data-theme="dark"] .fc-button:hover {
    background-color: #4b5563 !important;
}

[data-theme="dark"] .fc-button-primary {
    background-color: #3b82f6 !important;
    border-color: #3b82f6 !important;
}

[data-theme="dark"] .fc-col-header-cell {
    background-color: #374151 !important;
}

[data-theme="dark"] .fc-daygrid-day {
    background-color: #2d3748 !important;
}

[data-theme="dark"] .fc-day-today {
    background-color: #1e40af !important;
}

/* Theme Toggle Button */
.theme-toggle {
    background: none;
    border: none;
    color: #ffffff;
    font-size: 1.2rem;
    padding: 0.5rem;
    margin-right: 0.5rem;
    border-radius: 0.375rem;
    transition: all 0.2s ease;
    cursor: pointer;
}

.theme-toggle:hover {
    background-color: rgba(255, 255, 255, 0.1);
    transform: scale(1.05);
}

.theme-toggle:focus {
    outline: none;
    box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3);
}

[data-theme="dark"] .theme-toggle {
    color: #e9ecef;
}

[data-theme="dark"] .theme-toggle:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

/* ========================================
   ENHANCED FOCUS INDICATORS & ACCESSIBILITY
   ======================================== */

/* Enhanced focus styles for all interactive elements */
button:focus,
input:focus,
select:focus,
textarea:focus,
a:focus,
.btn:focus,
.form-control:focus,
.form-select:focus,
.nav-link:focus {
    outline: 2px solid var(--focus-color) !important;
    outline-offset: 2px !important;
    box-shadow: var(--focus-shadow) !important;
}

/* Dark mode focus styles */
[data-theme="dark"] button:focus,
[data-theme="dark"] input:focus,
[data-theme="dark"] select:focus,
[data-theme="dark"] textarea:focus,
[data-theme="dark"] a:focus,
[data-theme="dark"] .btn:focus,
[data-theme="dark"] .form-control:focus,
[data-theme="dark"] .form-select:focus,
[data-theme="dark"] .nav-link:focus {
    outline: 2px solid var(--focus-color) !important;
    outline-offset: 2px !important;
    box-shadow: var(--focus-shadow-dark) !important;
}

/* Skip link enhanced styles */
.skip-link:focus {
    outline: 3px solid #ffff00 !important;
    outline-offset: 2px !important;
    box-shadow: 0 0 0 5px rgba(255, 255, 0, 0.3) !important;
    background: #000 !important;
    color: #fff !important;
    text-decoration: none !important;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    :root {
        --bs-primary: #0000FF;
        --bs-success: #008000;
        --bs-danger: #FF0000;
        --bs-warning: #FF8C00;
        --focus-color: #0000FF;
    }
    
    button, .btn {
        border: 2px solid currentColor !important;
    }
    
    .text-muted {
        color: var(--high-contrast-text) !important;
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        transition-delay: 0s !important;
    }
    
    .theme-toggle,
    .nav-link,
    .btn {
        transition: none !important;
        transform: none !important;
    }
}

/* Keyboard navigation enhancements */
.nav-link:focus-visible,
.dropdown-item:focus-visible,
.btn:focus-visible {
    background-color: rgba(13, 110, 253, 0.1) !important;
    border-radius: 4px;
}

[data-theme="dark"] .nav-link:focus-visible,
[data-theme="dark"] .dropdown-item:focus-visible,
[data-theme="dark"] .btn:focus-visible {
    background-color: rgba(66, 153, 225, 0.2) !important;
}

/* Form validation enhancements */
.is-invalid:focus {
    outline: 2px solid var(--bs-danger) !important;
    box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.25) !important;
}

.is-valid:focus {
    outline: 2px solid var(--bs-success) !important;
    box-shadow: 0 0 0 0.25rem rgba(25, 135, 84, 0.25) !important;
}

/* Improved color contrast for text elements */
.text-muted {
    color: #6c757d !important; /* WCAG AA compliant */
}

[data-theme="dark"] .text-muted {
    color: #a0aec0 !important; /* Higher contrast for dark mode */
}

/* Alert contrast improvements */
.alert-warning {
    background-color: #fff3cd !important;
    border-color: #ffecb5 !important;
    color: #664d03 !important; /* Higher contrast */
}

.alert-info {
    background-color: #d1ecf1 !important;
    border-color: #b6d4ea !important;
    color: #055160 !important; /* Higher contrast */
}

/* Table accessibility improvements */
.table-hover tbody tr:hover {
    background-color: rgba(13, 110, 253, 0.075) !important;
}

[data-theme="dark"] .table-hover tbody tr:hover {
    background-color: rgba(66, 153, 225, 0.15) !important;
}

/* Button contrast improvements */
.btn-outline-secondary {
    color: #495057 !important;
    border-color: #495057 !important;
}

.btn-outline-secondary:hover {
    background-color: #495057 !important;
    color: #fff !important;
}

[data-theme="dark"] .btn-outline-secondary {
    color: #a0aec0 !important;
    border-color: #a0aec0 !important;
}

[data-theme="dark"] .btn-outline-secondary:hover {
    background-color: #a0aec0 !important;
    color: #1a1a1a !important;
}

/* ========================================
   DESIGN TOKEN UTILITY CLASSES
   ======================================== */

/* Background Color Utilities */
.bg-primary-custom { background-color: var(--color-primary) !important; }
.bg-primary-light { background-color: var(--color-primary-light) !important; }
.bg-primary-lighter { background-color: var(--color-primary-lighter) !important; }

.bg-success-custom { background-color: var(--color-success) !important; }
.bg-success-light { background-color: var(--color-success-light) !important; }
.bg-success-lighter { background-color: var(--color-success-lighter) !important; }

.bg-danger-custom { background-color: var(--color-danger) !important; }
.bg-danger-light { background-color: var(--color-danger-light) !important; }
.bg-danger-lighter { background-color: var(--color-danger-lighter) !important; }

.bg-warning-custom { background-color: var(--color-warning) !important; }
.bg-warning-light { background-color: var(--color-warning-light) !important; }
.bg-warning-lighter { background-color: var(--color-warning-lighter) !important; }

.bg-info-custom { background-color: var(--color-info) !important; }
.bg-info-light { background-color: var(--color-info-light) !important; }
.bg-info-lighter { background-color: var(--color-info-lighter) !important; }

.bg-gray-100 { background-color: var(--color-gray-100) !important; }
.bg-gray-200 { background-color: var(--color-gray-200) !important; }
.bg-gray-300 { background-color: var(--color-gray-300) !important; }

/* Text Color Utilities */
.text-primary-custom { color: var(--color-primary) !important; }
.text-success-custom { color: var(--color-success) !important; }
.text-success-custom-text { color: var(--color-success-text) !important; }
.text-danger-custom { color: var(--color-danger) !important; }
.text-danger-custom-text { color: var(--color-danger-text) !important; }
.text-warning-custom { color: var(--color-warning) !important; }
.text-warning-custom-text { color: var(--color-warning-text) !important; }
.text-info-custom { color: var(--color-info) !important; }
.text-info-custom-text { color: var(--color-info-text) !important; }

.text-primary-token { color: var(--color-text-primary) !important; }
.text-secondary-token { color: var(--color-text-secondary) !important; }
.text-muted-token { color: var(--color-text-muted) !important; }

/* Border Color Utilities */
.border-primary-custom { border-color: var(--color-primary) !important; }
.border-success-custom { border-color: var(--color-success) !important; }
.border-danger-custom { border-color: var(--color-danger) !important; }
.border-warning-custom { border-color: var(--color-warning) !important; }
.border-info-custom { border-color: var(--color-info) !important; }

.border-light-token { border-color: var(--color-border-light) !important; }
.border-medium-token { border-color: var(--color-border-medium) !important; }
.border-dark-token { border-color: var(--color-border-dark) !important; }

/* Button Hover States */
.btn-primary-custom:hover { background-color: var(--color-primary-hover) !important; }
.btn-success-custom:hover { background-color: var(--color-success-hover) !important; }
.btn-danger-custom:hover { background-color: var(--color-danger-hover) !important; }
.btn-warning-custom:hover { background-color: var(--color-warning-hover) !important; }
.btn-info-custom:hover { background-color: var(--color-info-hover) !important; }

/* Alert Styles Using Design Tokens */
.alert-success-token {
    background-color: var(--color-success-light) !important;
    border-color: var(--color-success) !important;
    color: var(--color-success-text) !important;
}

.alert-danger-token {
    background-color: var(--color-danger-light) !important;
    border-color: var(--color-danger) !important;
    color: var(--color-danger-text) !important;
}

.alert-warning-token {
    background-color: var(--color-warning-light) !important;
    border-color: var(--color-warning) !important;
    color: var(--color-warning-text) !important;
}

.alert-info-token {
    background-color: var(--color-info-light) !important;
    border-color: var(--color-info) !important;
    color: var(--color-info-text) !important;
}

/* Badge Styles Using Design Tokens */
.badge-success-token {
    background-color: var(--color-success) !important;
    color: var(--color-text-light) !important;
}

.badge-danger-token {
    background-color: var(--color-danger) !important;
    color: var(--color-text-light) !important;
}

.badge-warning-token {
    background-color: var(--color-warning) !important;
    color: var(--color-text-primary) !important;
}

.badge-info-token {
    background-color: var(--color-info) !important;
    color: var(--color-text-light) !important;
}